{% extends 'base.html' %}
{% load static %}
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
{% block 'usuario' %}
<span>{{ user }}</span>
{% endblock 'usuario' %}
{% block 'blankPage' %}
<!-- inicio pedidos -->
{% for pedido in pedidos %}
    <div class="row ">
            <div class="col-xl-6 col-lg-12 ">
              <form method="POST" action="{% url 'enviarProposta' %}">
                {% csrf_token %}
                <div class="card l-bg-gray">
                    <div class="card-statistic-3 p-4">
                        <div class="card-icon card-icon-large"><i class="fas fa fa-car"></i></div>
                        <div class="mb-3">
                          <!-- Inicio Carrossel -->
                          <div id="carouselExampleSlidesOnly" class="carousel slide" data-ride="carousel">
                            <div class="carousel-inner">
                              {% for imagem in imagens %}
                              <div class="carousel-item {% if forloop.first %} active {% endif %}">
                                <img class="d-block w-100" src="{{MEDIA_URL}}{{imagem.imagem}}">
                              </div>
                              {% endfor %}
                            </div>
                          </div>
                          <!-- Fim Carrossel -->
                        </div>
                        <div class="mb-3">
                          <input name="pedido" value={{pedido.id}} type="hidden"></input>
                            <h5 class="card-title mb-0">{{pedido.categoria_fk.categoria}}</h5>
                        </div>
                        <div class="row align-items-center mb-2 d-flex">
                            <div class="col-8">
                                <h4 class="d-flex align-items-center mb-0">
                                    {{pedido.titulo}}
                                </h4>
                            </div>
                            <div class="col-8">
                              <hr>
                              <h5 class="d-flex align-items-center mb-0">
                                Endereço:
                              </h5>
                            </div>
                            <div class="col-8">
                              <h6 class="d-flex align-items-center mb-0">
                                  {{pedido.endereco_fk.logradouro}},{{pedido.endereco_fk.numero}}
                              </h6>
                            </div>
                            <div class="col-8">
                              <h6 class="d-flex align-items-center mb-0">
                                  {{pedido.endereco_fk.cep}},{{pedido.endereco_fk.bairro}}{{pedido.endereco_fk.complemento}}
                              </h6>
                            </div>
                            <div class="col-8">
                            <h6 class="d-flex align-items-center mb-0">
                              {{pedido.endereco_fk.cidade}}-{{pedido.endereco_fk.uf}}
                            </h6>
                          </div>
                        </div>
                        </div>
                        <div data-height="50" style="height: 18px;">
                            <div>
                              <button type="button" class="btn l-bg-blue-dark" data-toggle="modal" data-target="#myModal" style="width:100%;height:35px;" >Enviar Proposta <i class="fa fa-eye"></i></button>
                            </div>
                        </div>
                    </div>
                  </div>
            </div>
        </form>

    <!-- Modal -->
    <div id="myModal" class="modal fade" role="dialog">
      <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content" >

          <div class="modal-header" aria-labelledby="exampleModalCenterTitle">
            <h5 class="modal-title">{{pedido.titulo}}</h5>
            <h6 class="modal-title" name="pedido">{{pedido.id}}</h6>
            <h6 class="modal-title" name="usuarioPedido">{{pedido.usuario_fk.username}}</h6>
          </div>
        <form method="POST" action="{% url 'enviarProposta'%}">
            {% csrf_token %}
            <input name="pedido" value={{pedido.id}} type="hidden"></input>
            <input name="usuarioPedido" value={{pedido.usuario_fk.id}} type="hidden"></input>
            <input name="usuarioProposta" value={{user}} type="hidden"></input>
            <div class="modal-body">
              <div class="col-sm-4 form-group" >
                <label for="valor">Valor</label>
                <input type="text" id="valor" name="valor" class="form-control col-sm-12" onkeyup="formatarMoeda();"/>
              </div>
            <div class="col-sm-12 form-group" >
              <label for="valor">Observações</label>
              <textarea class="form-control col-sm-12" name="observacao" >
              </textarea>
            </div>
            <div class="col-sm-12 form-group" >
              <label for="valor">Prev.Inicio</label>
              <input type="date" name="prevInicio" class="form-control  col-sm-12">
              <label for="valor">Prazo Término</label>
              <input type="number" name="prazoTermino" class="form-control  col-sm-12">
            </div>
            <div class="col-sm-4 form-group" >
            </div>
          </div>
          <div class="modal-footer">
            <button type="submit" class="btn btn-primary">Enviar proposta</button>
            <button type="button" class="btn btn-danger" data-dismiss="modal">Sair</button>
          </div>
        </form>
      </div>
      </div>
    </div>
  
{%endfor%}
<!-- final pedidos -->
{% endblock 'blankPage' %}  
{%  block 'js' %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-0evHe/X+R7YkIZDRvuzKMRqM+OrBnVFBL6DOitfPri4tjfHxaWutUpFmBp4vmVor" crossorigin="anonymous">
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.0-beta1/dist/js/bootstrap.bundle.min.js" integrity="sha384-pprn3073KE6tl6bjs2QrFaJGz5/SUsLqktiwsUTF55Jfv3qYSDhgCecCxMW52nD2" crossorigin="anonymous"></script>
<link rel="stylesheet" type="text/css" href="{% static 'css/estilo.css' %}">
<script src="{% static 'js/formataCampos.js' %}"></script>
<script src="{% static 'js/alteraImagem.js' %}"></script>
<script src="{% static 'js/contatos.js' %}"></script>
<script src="{% static 'js/cep.js' %}"></script>
<script src="{% static 'js/apis.js' %}"></script>
{% endblock %}
